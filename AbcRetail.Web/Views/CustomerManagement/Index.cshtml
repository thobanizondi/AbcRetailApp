@model List<AbcRetail.Core.Models.Customer>
@{
    ViewData["Title"] = "Customers";
    var q = Context.Request.Query["q"].ToString();
}
<h2 style="margin:0 0 20px;font-size:28px;">Customers</h2>
<form method="get" style="margin-bottom:16px;display:flex;gap:8px;align-items:flex-end;flex-wrap:wrap;">
    <div>
        <label style="display:block;font-size:12px;color:var(--muted);margin-bottom:4px;">Search (name/email)</label>
        <input type="text" name="q" value="@q" placeholder="Starts with..." />
    </div>
    <div style="align-self:flex-end;">
        <button class="btn" type="submit" style="height:38px;">Search</button>
        <a href="@Url.Action("Index")" class="btn outline" style="height:38px;">Reset</a>
    </div>
</form>
<table class="table">
    <thead>
        <tr><th>Email / ID</th><th>Name</th><th>Shipping</th><th>Status</th><th style="width:140px;">Actions</th></tr>
    </thead>
    <tbody>
    @if(Model!=null && Model.Any()){
        foreach(var c in Model){
            <tr class="@(c.IsDisabled?"muted":"")">
                <td style="font-family:monospace;">@c.CustomerId</td>
                <td>@c.Name</td>
                <td style="max-width:240px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;">@c.ShippingAddress</td>
                <td>
                    @if(c.IsDisabled){<span class="status Canceled" style="background:#b00;">Disabled</span>}else{<span class="status Completed" style="background:#2c8a2c;">Active</span>}
                </td>
                <td>
                    <form asp-action="Toggle" method="post" style="display:inline;">
                        @Html.AntiForgeryToken()
                        <input type="hidden" name="id" value="@c.CustomerId" />
                        <input type="hidden" name="q" value="@q" />
                        @if(c.IsDisabled){
                            <button class="btn" name="disable" value="false" style="padding:4px 10px;font-size:12px;">Enable</button>
                        } else {
                            <button class="btn outline" name="disable" value="true" style="padding:4px 10px;font-size:12px;">Disable</button>
                        }
                    </form>
                </td>
            </tr>
        }
    } else {
        <tr><td colspan="5" style="font-size:13px;color:var(--muted);">No customers found.</td></tr>
    }
    </tbody>
</table>
